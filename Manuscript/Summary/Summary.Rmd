---
output: pdf_document
---

# Brief methological explanation and preliminary results

Here we summarise all the critical steps conducted to analise bee preferences.

## Filtering criteria

1) Filter records above 1985 and 1987 (this is decided based on the GIS data available) for Europe and USA respectively.

2) Filter by unique capture event.

3) Filter by minimum of 3 decimals on coordinates.

4) Filter number of levels per species (minimum sample size, 100 occurrences).

5) Filter by wide geographical distribution.

\newpage

# Europe (4 levels)

```{r Load Europe data, eval=TRUE, include=FALSE}
library(tidyverse)
pref <- read_csv("Data/Europe_data/land_cover_europe.csv.gz") %>% 
    dplyr::select(Species, Cover_names) %>% 
    mutate_if(is.character,as.factor) 

```

```{r Table with all levels Europe, echo = FALSE, warning = FALSE, message = FALSE}
library(kableExtra)

pref %>% 
group_by(Cover_names) %>% 
summarise(n_rows = length(Cover_names)) %>% 
filter(!Cover_names=="NODATA") %>% 
rename(Land_use = Cover_names) %>% 
arrange(desc(n_rows)) %>% 
mutate(Cover_names = fct_recode(as.factor(Land_use),
#1 Check with Nacho, dehesas and others 
 Seminatural = "Agro-forestry areas", #1) 2.4.4 
#2 Check with Nacho 
 Urban = "Airports", #2) 1.2.4 
#3 Crops 
 Agricultural = "Annual crops associated with permanent crops", #3) 2.4.1 
#4 Very different cover type, not included 
 Discard = "Bare rocks", #4) 3.3.2 
#5 Very different cover type, not included 
 Discard = "Beaches, dunes, sands", #5) 3.3.1 
#6 Not included, lack of details 
 Discard = "Burnt areas", #6 3.3.4
#7 Not included, only water surface
 Discard = "Coastal lagoons", #7) 5.2.1 
#8 Straightforward
 Natural = "Coniferous forest", #8) 3.1.2
#9 Excluded, complex to consider because it lacks habitat context
 Urban = "Construction sites", #9) 1.3.3
#10 Based on the images and the description has a lot of vegetation cover
 Seminatural = "Discontinuous urban fabric", #10) 1.1.2
#11 Pollinators here are likely to depend much on the context not on the dump
 Discard = "Dump sites", #11) 1.3.2
#12 Filter out, water body
 Discard = "Estuaries", #12) 5.2.2 
#13 Straightforward
Agricultural = "Fruit trees and berry plantations", #13) 2.2.2
#14 Urban as embedded within the city
 Urban = "Green urban areas", #14) 1.4.1
#15 Highly modified
Urban = "Industrial or commercial units", #15) 1.2.1
#16 By definion, seminatural
Seminatural = "Land principally occupied by agriculture, with significant areas of natural vegetation", #16) 2.4.3
#17 Discard as is not clear the vegetation context
Discard = "Mineral extraction sites", #17) 1.3.1
#18 Straightforward 3.1.3
 Natural = "Mixed forest", #18) 3.1.3
#19 Crystal clear category
 Natural = "Moors and heathland", #19) 3.2.2
#20 Crystal clear category
 Natural = "Natural grasslands", #20) 3.2.1
#21 Filter out
 Discard = "NODATA", #21 
#22 cultivated land
 Agricultural = "Non-irrigated arable land", #22) 2.1.1
#23 As it is a monoculture despite some very
 Agricultural = "Olive groves", #23) 2.2.3
#24 Crystal clear category
 Natural = "Peat bogs", #24) 4.1.2
#25 Crystal clear category
 Seminatural = "Permanently irrigated land", #25) 2.1.2
#26 Check with Nacho
 Urban = "Port areas", #26) 1.2.3
#27 Check with Nacho
 Seminatural = "Road and rail networks and associated land", #27) 1.2.2
#28 Check with Nacho but just only 200 records
 Seminatural = "Salines", #28) 4.2.2 
#29 Flowering plant communities 
 Natural = "Salt marshes", #29) 4.2.1
#30 Sclerophyllous shrubs and low shrubs
 Natural = "Sclerophyllous vegetation", #30) 3.2.3
#31 Discard for now 
 Discard = "Sea and ocean", #31) 5.2.3
#32 Areas with sparse vegetation, covering 10-50% of surface 
 Natural = "Sparsely vegetated areas", #32) 3.3.3
#33 Check with Nacho 
 Seminatural = "Sport and leisure facilities", #33) 1.4.2 
#34 Excluded as it is very general
 Discard = "Water bodies", #34) 5.1.2
#35 Excluded as it is very general
 Discard = "Water courses" #35 5.1.1 
)) %>%  
kbl() %>% 
kable_styling(font_size = 8,latex_options = "hold_position")

```

Check final levels per category:

```{r Show levels Europe, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE}
pref1 = pref %>% 
mutate(Cover_names = fct_recode(as.factor(Cover_names),
#1 Check with Nacho, dehesas and others 
Seminatural = "Agro-forestry areas", #1) 2.4.4 
#2 Check with Nacho 
Urban = "Airports", #2) 1.2.4 
#3 Crops 
Agricultural = "Annual crops associated with permanent crops", #3) 2.4.1 
#4 Very different cover type, not included 
Discard = "Bare rocks", #4) 3.3.2 
#5 Very different cover type, not included 
Discard = "Beaches, dunes, sands", #5) 3.3.1 
#6 Not included, lack of details 
Discard = "Burnt areas", #6 3.3.4
#7 Not included, only water surface
Discard = "Coastal lagoons", #7) 5.2.1 
#8 Straightforward
Natural = "Coniferous forest", #8) 3.1.2
#9 Excluded, complex to consider because it lacks habitat context
Urban = "Construction sites", #9) 1.3.3
#10 Based on the images and the description has a lot of vegetation cover
Urban = "Discontinuous urban fabric", #10) 1.1.2
#11 Pollinators here are likely to depend much on the context not on the dump
Discard = "Dump sites", #11) 1.3.2
#12 Filter out, water body
Discard = "Estuaries", #12) 5.2.2 
#13 Straightforward
Agricultural = "Fruit trees and berry plantations", #13) 2.2.2
#14 Urban as embedded within the city
Urban = "Green urban areas", #14) 1.4.1
#15 Highly modified
Urban = "Industrial or commercial units", #15) 1.2.1
#16 By definion, seminatural
Seminatural = "Land principally occupied by agriculture, with significant areas of natural vegetation", #16) 2.4.3
#17 Discard as is not clear the vegetation context
Discard = "Mineral extraction sites", #17) 1.3.1
#18 Straightforward 3.1.3
Natural = "Mixed forest", #18) 3.1.3
#19 Crystal clear category
Natural = "Moors and heathland", #19) 3.2.2
#20 Crystal clear category
Natural = "Natural grasslands", #20) 3.2.1
#21 Filter out
Discard = "NODATA", #21 
#22 cultivated land
Agricultural = "Non-irrigated arable land", #22) 2.1.1
#23 As it is a monoculture despite some very
Agricultural = "Olive groves", #23) 2.2.3
#24 Crystal clear category
Natural = "Peat bogs", #24) 4.1.2
#25 Crystal clear category
Seminatural = "Permanently irrigated land", #25) 2.1.2
#26 Check with Nacho
Urban = "Port areas", #26) 1.2.3
#27 Check with Nacho
Seminatural = "Road and rail networks and associated land", #27) 1.2.2
#28 Check with Nacho but just only 200 records
Seminatural = "Salines", #28) 4.2.2 
#29 Flowering plant communities 
Natural = "Salt marshes", #29) 4.2.1
#30 Sclerophyllous shrubs and low shrubs
Natural = "Sclerophyllous vegetation", #30) 3.2.3
#31 Discard for now 
Discard = "Sea and ocean", #31) 5.2.3
#32 Areas with sparse vegetation, covering 10-50% of surface 
Natural = "Sparsely vegetated areas", #32) 3.3.3
#33 Check with Nacho 
Seminatural = "Sport and leisure facilities", #33) 1.4.2 
#34 Excluded as it is very general
Discard = "Water bodies", #34) 5.1.2
#35 Excluded as it is very general
Discard = "Water courses" #35 5.1.1 
)) %>% 
filter(!Cover_names == "Discard") 

pref1 %>% 
group_by(Cover_names) %>% 
summarise(Levels = length(Cover_names)) %>% 
kbl() %>% 
kable_styling(latex_options = "hold_position")
```

\newpage

# Europe (3 levels)

```{r Table with restricted levels Europe, echo = FALSE, warning = FALSE, message = FALSE}
library(kableExtra)


pref %>% 
group_by(Cover_names) %>% 
summarise(n_rows = length(Cover_names)) %>% 
filter(!Cover_names=="NODATA") %>% 
rename(Land_use = Cover_names) %>% 
arrange(desc(n_rows)) %>% 
mutate(Cover_names = fct_recode(as.factor(Land_use),
#1 Check with Nacho, dehesas and others 
Discard = "Agro-forestry areas", #1) 2.4.4 
#2 Check with Nacho 
Discard = "Airports", #2) 1.2.4 
#3 Crops 
Agricultural = "Annual crops associated with permanent crops", #3) 2.4.1 
#4 Very different cover type, not included 
Discard = "Bare rocks", #4) 3.3.2 
#5 Very different cover type, not included 
Discard = "Beaches, dunes, sands", #5) 3.3.1 
#6 Not included, lack of details 
Discard = "Burnt areas", #6 3.3.4
#7 Not included, only water surface
Discard = "Coastal lagoons", #7) 5.2.1 
#8 Straightforward
Natural = "Coniferous forest", #8) 3.1.2
#9 Excluded, complex to consider because it lacks habitat context
Discard = "Construction sites", #9) 1.3.3
#10 Based on the images and the description has a lot of vegetation cover
Discard = "Discontinuous urban fabric", #10) 1.1.2
#11 Pollinators here are likely to depend much on the context not on the dump
Discard = "Dump sites", #11) 1.3.2
#12 Filter out, water body
Discard = "Estuaries", #12) 5.2.2 
#13 Straightforward
Agricultural = "Fruit trees and berry plantations", #13) 2.2.2
#14 Urban as embedded within the city
Discard = "Green urban areas", #14) 1.4.1
#15 Highly modified
Urban = "Industrial or commercial units", #15) 1.2.1
#16 By definion, seminatural
Agricultural = "Land principally occupied by agriculture, with significant areas of natural vegetation", #16) 2.4.3
#17 Discard as is not clear the vegetation context
Discard = "Mineral extraction sites", #17) 1.3.1
#18 Straightforward 3.1.3
Natural = "Mixed forest", #18) 3.1.3
#19 Crystal clear category
Discard = "Moors and heathland", #19) 3.2.2
#20 Crystal clear category
Discard = "Natural grasslands", #20) 3.2.1
#21 Filter out
Discard = "NODATA", #21 
#22 cultivated land
Agricultural = "Non-irrigated arable land", #22) 2.1.1
#23 As it is a monoculture despite some very
Discard = "Olive groves", #23) 2.2.3
#24 Crystal clear category
Discard = "Peat bogs", #24) 4.1.2
#25 Crystal clear category
Agricultural = "Permanently irrigated land", #25) 2.1.2
#26 Check with Nacho
Discard = "Port areas", #26) 1.2.3
#27 Check with Nacho
Discard = "Road and rail networks and associated land", #27) 1.2.2
#28 Check with Nacho but just only 200 records
Discard = "Salines", #28) 4.2.2 
#29 Flowering plant communities 
Discard = "Salt marshes", #29) 4.2.1
#30 Sclerophyllous shrubs and low shrubs
Discard = "Sclerophyllous vegetation", #30) 3.2.3
#31 Discard for now 
Discard = "Sea and ocean", #31) 5.2.3
#32 Areas with sparse vegetation, covering 10-50% of surface 
Discard = "Sparsely vegetated areas", #32) 3.3.3
#33 Check with Nacho 
Discard = "Sport and leisure facilities", #33) 1.4.2 
#34 Excluded as it is very general
Discard = "Water bodies", #34) 5.1.2
#35 Excluded as it is very general
Discard = "Water courses" #35 5.1.1 
)) %>%  
kbl() %>% 
kable_styling(font_size = 8,latex_options = "hold_position")

```


Check final levels per category:

```{r Show levels restricted land use Europe, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE}
pref2 = pref %>% 
mutate(Cover_names = fct_recode(as.factor(Cover_names),
#1 Check with Nacho, dehesas and others 
Discard = "Agro-forestry areas", #1) 2.4.4 
#2 Check with Nacho 
Discard = "Airports", #2) 1.2.4 
#3 Crops 
Agricultural = "Annual crops associated with permanent crops", #3) 2.4.1 
#4 Very different cover type, not included 
Discard = "Bare rocks", #4) 3.3.2 
#5 Very different cover type, not included 
Discard = "Beaches, dunes, sands", #5) 3.3.1 
#6 Not included, lack of details 
Discard = "Burnt areas", #6 3.3.4
#7 Not included, only water surface
Discard = "Coastal lagoons", #7) 5.2.1 
#8 Straightforward
Natural = "Coniferous forest", #8) 3.1.2
#9 Excluded, complex to consider because it lacks habitat context
Discard = "Construction sites", #9) 1.3.3
#10 Based on the images and the description has a lot of vegetation cover
Discard = "Discontinuous urban fabric", #10) 1.1.2
#11 Pollinators here are likely to depend much on the context not on the dump
Discard = "Dump sites", #11) 1.3.2
#12 Filter out, water body
Discard = "Estuaries", #12) 5.2.2 
#13 Straightforward
Agricultural = "Fruit trees and berry plantations", #13) 2.2.2
#14 Urban as embedded within the city
Discard = "Green urban areas", #14) 1.4.1
#15 Highly modified
Urban = "Industrial or commercial units", #15) 1.2.1
#16 By definion, seminatural
Agricultural = "Land principally occupied by agriculture, with significant areas of natural vegetation", #16) 2.4.3
#17 Discard as is not clear the vegetation context
Discard = "Mineral extraction sites", #17) 1.3.1
#18 Straightforward 3.1.3
Natural = "Mixed forest", #18) 3.1.3
#19 Crystal clear category
Discard = "Moors and heathland", #19) 3.2.2
#20 Crystal clear category
Discard = "Natural grasslands", #20) 3.2.1
#21 Filter out
Discard = "NODATA", #21 
#22 cultivated land
Agricultural = "Non-irrigated arable land", #22) 2.1.1
#23 As it is a monoculture despite some very
Discard = "Olive groves", #23) 2.2.3
#24 Crystal clear category
Discard = "Peat bogs", #24) 4.1.2
#25 Crystal clear category
Agricultural = "Permanently irrigated land", #25) 2.1.2
#26 Check with Nacho
Discard = "Port areas", #26) 1.2.3
#27 Check with Nacho
Discard = "Road and rail networks and associated land", #27) 1.2.2
#28 Check with Nacho but just only 200 records
Discard = "Salines", #28) 4.2.2 
#29 Flowering plant communities 
Discard = "Salt marshes", #29) 4.2.1
#30 Sclerophyllous shrubs and low shrubs
Discard = "Sclerophyllous vegetation", #30) 3.2.3
#31 Discard for now 
Discard = "Sea and ocean", #31) 5.2.3
#32 Areas with sparse vegetation, covering 10-50% of surface 
Discard = "Sparsely vegetated areas", #32) 3.3.3
#33 Check with Nacho 
Discard = "Sport and leisure facilities", #33) 1.4.2 
#34 Excluded as it is very general
Discard = "Water bodies", #34) 5.1.2
#35 Excluded as it is very general
Discard = "Water courses" #35 5.1.1 
)) %>% 
filter(!Cover_names == "Discard") 

pref2 %>% 
group_by(Cover_names) %>% 
summarise(Levels = length(Cover_names)) %>% 
kbl() %>% 
kable_styling(latex_options = "hold_position")
```


\clearpage



```{r Plotting Europe, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE, fig.height=10, fig.width=7, fig.pos="center", out.width="90%"}

library(tidyverse)

long_data <- read_csv("Data/Europe_data/data_preference_residuals_europe.csv")

model1 = read_csv("Data/Europe_data/model_output_preference_residuals_europe.csv")

model2 = read_csv("Data/Europe_data/model_output_preference_brain_weight_europe.csv")

model3 = read_csv("Data/Europe_data/model_output_preference_it_europe.csv")

model4 = read_csv("Data/Europe_data/model_output_preference_brain_it_europe.csv")

p1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("Europe 4 levels")+
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("Europe 4 levels")+
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


p3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("Europe 4 levels")  +
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight / IT") +
ggtitle("Europe 4 levels")  +
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

#Read data with land use filtered
long_data <- read_csv("Data/Europe_data/data_preference_residuals_europe_subset.csv")

model1 = read_csv("Data/Europe_data/model_output_preference_residuals_europe_subset.csv")

model2 = read_csv("Data/Europe_data/model_output_preference_brain_weight_europe_subset.csv")

model3 = read_csv("Data/Europe_data/model_output_preference_it_europe_subset.csv")

model4 = read_csv("Data/Europe_data/model_output_preference_brain_it_europe_subset.csv")

pp1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("Europe 3 levels")+
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))+
    theme(legend.position = "none")

pp2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("Europe 3 levels")+
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))+
    theme(legend.position = "none")


pp3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("Europe 3 levels") +
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
    theme(legend.position = "none")

pp4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight / IT") +
ggtitle("Europe 3 levels") +
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
    theme(legend.position = "none")


library(patchwork)
p1 + pp1 + p2 + pp2 + p3 + pp3 + p4 + pp4 + plot_layout(ncol = 2) + plot_layout(guides = "collect")

```

\newpage

# Europe 

Qualitative analysis on the statistical evidences for preference and avoidance by habitat

```{r Plotting Europe qualitative analysis, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE, fig.height=10, fig.width=7, fig.pos="center", out.width="80%"}

library(tidyverse)

long_data <- read_csv("Data/Europe_data/data_preference_residuals_europe_qualitative.csv")

model1 = read_csv("Data/Europe_data/model_output_preference_residuals_europe_qualitative.csv")

model2 = read_csv("Data/Europe_data/model_output_preference_brain_weight_europe_qualitative.csv")

model3 = read_csv("Data/Europe_data/model_output_preference_it_europe_qualitative.csv")

model4 = read_csv("Data/Europe_data/model_output_preference_brain_it_europe_qualitative.csv")

p1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA-Europe 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA-Europe 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


p3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA-Europe 4 levels")  + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight / IT") +
ggtitle("USA-Europe 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


#Load land use filtered data and models
long_data <- read_csv("Data/Europe_data/data_preference_residuals_europe_qualitative_subset.csv")

model1 = read_csv("Data/Europe_data/model_output_preference_residuals_europe_qualitative_subset.csv")

model2 = read_csv("Data/Europe_data/model_output_preference_brain_weight_europe_qualitative_subset.csv")

model3 = read_csv("Data/Europe_data/model_output_preference_it_europe_qualitative_subset.csv")

model4 = read_csv("Data/Europe_data/model_output_preference_brain_it_europe_qualitative_subset.csv")

pp1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA-Europe 3 levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA-Europe 3 levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")


pp3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA-Europe 3 levels")  + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight /` IT") +
ggtitle("USA-Europe 3 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

library(patchwork)
p1 + pp1 + p2 + pp2 + p3 + pp3 + p4 + pp4 + plot_layout(ncol = 2) + plot_layout(guides = "collect")

```


\newpage

# USA (4 levels) 

```{r Load USA data, eval=TRUE, include=FALSE}
#Load extracted data
pref <- read_csv("Data/Usa_data/land_cover_usa.csv.gz") %>% 
dplyr::select(species, cover.names) %>% 
mutate_if(is.character,as.factor) 

```


```{r Table with all levels USA, echo = FALSE, warning = FALSE, message = FALSE}

pref %>% 
group_by(cover.names) %>% 
summarise(n_rows = length(cover.names)) %>% 
rename(Land_use = cover.names) %>% 
arrange(desc(n_rows)) %>% 
mutate(Cover_names = fct_recode(as.factor(Land_use),
Discard = "Barren Land", #Very different cover type, not included  
Agricultural = "Cultivated Crops", #
Natural = "Deciduous Forest", #
Urban = "Developed, High Intensity", #Greater than 50% of cover  
Urban = "Developed, Medium Intensity", #Greater than 50% of cover  
Seminatural = "Developed, Low Intensity", #Low urban impact 
Seminatural = "Developed, Open Space", #Open areas with vegetation 
Natural = "Emergent Herbaceous Wetlands", #
Natural = "Evergreen Forest", #
Agricultural = "Hay/Pasture", #Highly managed by humans 
Natural = "Herbaceous", #See explanation below 
Natural = "Mixed Forest", #
Discard = "Open Water", #Low vegetation and land, not included 
Natural = "Shrub/Scrub", #Heath classified as natural 
Natural = "Woody Wetlands")) %>% 
kbl() %>% 
kable_styling(latex_options = "hold_position", font_size = 10)


```


Check final levels per category:

```{r Show levels USA, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE}

 pref %>% 
mutate(cover.names = fct_recode(as.factor(cover.names),
      Discard = "Barren Land", #Very different cover type, not included (MA & JB)
      Agricultural = "Cultivated Crops", #(MA & JB)
      Natural = "Deciduous Forest", #(MA & JB)
      Urban = "Developed, High Intensity", #Greater than 50% of cover (MA & JB) 
      Urban = "Developed, Medium Intensity", #Greater than 50% of cover (MA & JB) 
      Seminatural = "Developed, Low Intensity", #Low urban impact (MA & JB)
      Seminatural = "Developed, Open Space", #Open areas with vegetation (MA & JB)
      Natural = "Emergent Herbaceous Wetlands", #(MA & JB)
      Natural = "Evergreen Forest", #(MA & JB)
      Agricultural = "Hay/Pasture", #Highly managed by humans (MA & JB)
      Natural = "Herbaceous", #See explanation below (MA & JB)
      Natural = "Mixed Forest", #(MA & JB)
      Discard = "Open Water", #Low vegetation and land, not included (MA & JB)
      Natural = "Shrub/Scrub", #Heath classified as natural (MA & JB)
      Natural = "Woody Wetlands")) %>% #(MA & JB)
filter(!cover.names == "Discard") %>%  #Discard these categories classified as "Discard"
#Herbaceous and hay/pasture are classified as two different habitats in NLCD. 
#We merged them because herbaceous areas in our sampling region are always 
#for livestock (Koh et al., 2016).
group_by(cover.names) %>% 
summarise(n_rows = length(cover.names)) %>% 
arrange(desc(n_rows)) %>%     
kbl() %>% 
kable_styling(latex_options = "hold_position")

```

\newpage


# USA (3 levels) 


```{r Show levels USA subset, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE}

pref_subset <- read_csv("Data/Usa_data/land_cover_usa.csv.gz") %>% 
    dplyr::select(species, cover.names) %>% 
    mutate_if(is.character,as.factor) 

pref_subset %>% 
group_by(cover.names) %>% 
summarise(n_rows = length(cover.names)) %>% 
rename(Land_use = cover.names) %>% 
arrange(desc(n_rows)) %>% 
mutate(Cover_names = fct_recode(as.factor(Land_use),
Discard = "Barren Land", #Very different cover type, not included (MA & JB)
Agricultural = "Cultivated Crops", #(MA & JB)
Natural = "Deciduous Forest", #(MA & JB)
Urban = "Developed, High Intensity", #Greater than 50% of cover (MA & JB) 
Urban = "Developed, Medium Intensity", #Greater than 50% of cover (MA & JB) 
Discard = "Developed, Low Intensity", #Low urban impact (MA & JB)
Discard = "Developed, Open Space", #Open areas with vegetation (MA & JB)
Discard = "Emergent Herbaceous Wetlands", #(MA & JB)
Natural = "Evergreen Forest", #(MA & JB)
Discard = "Hay/Pasture", #Highly managed by humans (MA & JB)
Discard = "Herbaceous", #See explanation below (MA & JB)
Natural = "Mixed Forest", #(MA & JB)
Discard = "Open Water", #Low vegetation and land, not included (MA & JB)
Natural = "Shrub/Scrub", #Heath classified as natural (MA & JB)
Natural = "Woody Wetlands")) %>% 
kbl() %>% 
kable_styling(latex_options = "hold_position", font_size = 10)
```

Check number of levels per category:

```{r Show levels USA subset levels, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE}

 pref_subset %>% 
mutate(cover.names = fct_recode(as.factor(cover.names),
Discard = "Barren Land", #Very different cover type, not included (MA & JB)
Agricultural = "Cultivated Crops", #(MA & JB)
Natural = "Deciduous Forest", #(MA & JB)
Urban = "Developed, High Intensity", #Greater than 50% of cover (MA & JB) 
Urban = "Developed, Medium Intensity", #Greater than 50% of cover (MA & JB) 
Discard = "Developed, Low Intensity", #Low urban impact (MA & JB)
Discard = "Developed, Open Space", #Open areas with vegetation (MA & JB)
Discard = "Emergent Herbaceous Wetlands", #(MA & JB)
Natural = "Evergreen Forest", #(MA & JB)
Discard = "Hay/Pasture", #Highly managed by humans (MA & JB)
Discard = "Herbaceous", #See explanation below (MA & JB)
Natural = "Mixed Forest", #(MA & JB)
Discard = "Open Water", #Low vegetation and land, not included (MA & JB)
Natural = "Shrub/Scrub", #Heath classified as natural (MA & JB)
Natural = "Woody Wetlands")) %>% #(MA & JB)
filter(!cover.names == "Discard") %>% 
group_by(cover.names) %>% 
summarise(n_rows = length(cover.names)) %>% 
arrange(desc(n_rows)) %>%     
kbl() %>% 
kable_styling(latex_options = "hold_position")

```

\newpage

# USA (Gbif and MA thesis data)

```{r Plotting USA gbif and MA thesis data, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE, fig.height=10, fig.width=7, fig.pos="center", out.width="90%"}

library(tidyverse)

long_data <- read_csv("Data/Usa_data/data_preference_residuals_usa.csv")

model1 = read_csv("Data/Usa_data/model_output_preference_residuals_usa.csv")

model2 = read_csv("Data/Usa_data/model_output_preference_brain_weight_usa.csv")

model3 = read_csv("Data/Usa_data/model_output_preference_it_usa.csv")

model4 = read_csv("Data/Usa_data/model_output_preference_brain_it_usa.csv")

p1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


p3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA 4 levels")  + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight / IT") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


#Load land use filtered data and models
long_data <- read_csv("Data/Usa_data/data_preference_residuals_usa_subset.csv")

model1 = read_csv("Data/Usa_data/model_output_preference_residuals_usa_subset.csv")

model2 = read_csv("Data/Usa_data/model_output_preference_brain_weight_usa_subset.csv")

model3 = read_csv("Data/Usa_data/model_output_preference_it_usa_subset.csv")

model4 = read_csv("Data/Usa_data/model_output_preference_brain_it_usa_subset.csv")

pp1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA 3 levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA 3 levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")


pp3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA 3 levels")  + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight /` IT") +
ggtitle("USA 3 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

library(patchwork)
p1 + pp1 + p2 + pp2 + p3 + pp3 + p4 + pp4 + plot_layout(ncol = 2) + plot_layout(guides = "collect")

```

\newpage

# USA (Gbif and MA thesis data) 

Qualitative analysis on the statistical evidences for preference and avoidance by habitat

```{r Plotting USA qualitative, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE, fig.height=10, fig.width=7, fig.pos="center", out.width="80%"}

library(tidyverse)

long_data <- read_csv("Data/Usa_data/data_preference_residuals_usa_qualitative.csv")

model1 = read_csv("Data/Usa_data/model_output_preference_residuals_usa_qualitative.csv")

model2 = read_csv("Data/Usa_data/model_output_preference_brain_weight_usa_qualitative.csv")

model3 = read_csv("Data/Usa_data/model_output_preference_it_usa_qualitative.csv")

model4 = read_csv("Data/Usa_data/model_output_preference_brain_it_usa_qualitative.csv")

p1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


p3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA 4 levels")  + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight / IT") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


#Load land use filtered data and models
long_data <- read_csv("Data/Usa_data/data_preference_residuals_usa_qualitative_subset.csv")

model1 = read_csv("Data/Usa_data/model_output_preference_residuals_usa_qualitative_subset.csv")

model2 = read_csv("Data/Usa_data/model_output_preference_brain_weight_usa_qualitative_subset.csv")

model3 = read_csv( "Data/Usa_data/model_output_preference_it_usa_qualitative_subset.csv")

model4 = read_csv("Data/Usa_data/model_output_preference_brain_it_usa_qualitative_subset.csv")

pp1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")


pp3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA levels")  + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight /` IT") +
ggtitle("USA levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

library(patchwork)
p1 + pp1 + p2 + pp2 + p3 + pp3 + p4 + pp4 + plot_layout(ncol = 2) + plot_layout(guides = "collect")

```


\newpage

# USA (just Gbif without MA thesis data)

```{r Plotting USA gbif, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE, fig.height=10, fig.width=7, fig.pos="center", out.width="90%"}

library(tidyverse)

long_data <- read_csv("Data/Usa_data/data_preference_residuals_usa_gbif.csv")

model1 = read_csv("Data/Usa_data/model_output_preference_residuals_usa_gbif.csv")

model2 = read_csv("Data/Usa_data/model_output_preference_brain_weight_usa_gbif.csv")

model3 = read_csv("Data/Usa_data/model_output_preference_it_usa_gbif.csv")

model4 = read_csv("Data/Usa_data/model_output_preference_brain_it_usa_gbif.csv")

p1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


p3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA 4 levels")  + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight / IT") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


#Load land use filtered data and models
long_data <- read_csv("Data/Usa_data/data_preference_residuals_usa_subset_gbif.csv")

model1 = read_csv("Data/Usa_data/model_output_preference_residuals_usa_subset_gbif.csv")

model2 = read_csv("Data/Usa_data/model_output_preference_brain_weight_usa_subset_gbif.csv")

model3 = read_csv("Data/Usa_data/model_output_preference_it_usa_subset_gbif.csv")

model4 = read_csv("Data/Usa_data/model_output_preference_brain_it_usa_subset_gbif.csv")

pp1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA 3 levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA 3 levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")


pp3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA 3 levels")  + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight /` IT") +
ggtitle("USA 3 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

library(patchwork)
p1 + pp1 + p2 + pp2 + p3 + pp3 + p4 + pp4 + plot_layout(ncol = 2) + plot_layout(guides = "collect")

```

\newpage

# USA and Europe together

```{r Plotting USA Europe together, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE, fig.height=10, fig.width=7, fig.pos="center", out.width="90%"}

library(tidyverse)

long_data <- read_csv("Data/Europe_USA/data_preference_residuals_europe_usa.csv")

model1 = read_csv("Data/Europe_USA/model_output_preference_residuals_europe_usa.csv")

model2 = read_csv("Data/Europe_USA/model_output_preference_brain_weight_europe_usa.csv")

model3 = read_csv("Data/Europe_USA/model_output_preference_it_europe_usa.csv")

model4 = read_csv("Data/Europe_USA/model_output_preference_brain_it_europe_usa.csv")

p1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA-Europe 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA-Europe 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


p3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA-Europe 4 levels")  + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight / IT") +
ggtitle("USA-Europe 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


#Load land use filtered data and models
long_data <- read_csv("Data/Europe_USA/data_preference_residuals_europe_usa_subset.csv")

model1 = read_csv("Data/Europe_USA/model_output_preference_residuals_europe_usa_subset.csv")

model2 = read_csv("Data/Europe_USA/model_output_preference_brain_weight_europe_usa_subset.csv")

model3 = read_csv("Data/Europe_USA/model_output_preference_it_europe_usa_subset.csv")

model4 = read_csv("Data/Europe_USA/model_output_preference_brain_it_europe_usa_subset.csv")

pp1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA-Europe 3 levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA-Europe 3 levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")


pp3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA-Europe 3 levels")  + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight /` IT") +
ggtitle("USA-Europe 3 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

library(patchwork)
p1 + pp1 + p2 + pp2 + p3 + pp3 + p4 + pp4 + plot_layout(ncol = 2) + plot_layout(guides = "collect")

```


\newpage


# USA and Europe together 

Qualitative analysis on the statistical evidences for preference and avoidance by habitat


```{r Plotting USA Europe together qualitative, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE, fig.height=10, fig.width=7, fig.pos="center", out.width="90%"}

library(tidyverse)

long_data <- read_csv("Data/Europe_USA/data_preference_residuals_europe_usa_qualitative.csv")

model1 = read_csv("Data/Europe_USA/model_output_preference_residuals_europe_usa_qualitative.csv")

model2 = read_csv("Data/Europe_USA/model_output_preference_brain_weight_europe_usa_qualitative.csv")

model3 = read_csv("Data/Europe_USA/model_output_preference_it_europe_usa_qualitative.csv")

model4 = read_csv("Data/Europe_USA/model_output_preference_brain_it_europe_usa_qualitative.csv")

p1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


p3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA 4 levels")  + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight / IT") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


#Load land use filtered data and models
long_data <- read_csv("Data/Europe_USA/data_preference_residuals_europe_usa_subset_qualitative.csv")

model1 = read_csv("Data/Europe_USA/model_output_preference_residuals_europe_usa_subset_qualitative.csv")

model2 = read_csv("Data/Europe_USA/model_output_preference_brain_weight_europe_usa_subset_qualitative.csv")

model3 = read_csv("Data/Europe_USA/model_output_preference_it_europe_usa_subset_qualitative.csv")

model4 = read_csv("Data/Europe_USA/model_output_preference_brain_it_europe_usa_subset_qualitative.csv")

pp1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")


pp3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA levels")  + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight /` IT") +
ggtitle("USA levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

library(patchwork)
p1 + pp1 + p2 + pp2 + p3 + pp3 + p4 + pp4 + plot_layout(ncol = 2) + plot_layout(guides = "collect")

```

