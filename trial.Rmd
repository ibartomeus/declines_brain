---
title: "Untitled"
output: html_document
---


```{r Plotting USA Europe together, eval = TRUE, fig.align = 'center', echo = FALSE, warning = FALSE, message = FALSE, fig.height=10, fig.width=7, fig.pos="center", out.width="90%"}

library(tidyverse)

long_data <- read_csv("Data/Europe_USA/data_preference_residuals_europe_usa_qualitative.csv")

model1 = read_csv("Data/Europe_USA/model_output_preference_residuals_europe_usa_qualitative.csv")

model2 = read_csv("Data/Europe_USA/model_output_preference_brain_weight_europe_usa_qualitative.csv")

model3 = read_csv("Data/Europe_USA/model_output_preference_it_europe_usa_qualitative.csv")

model4 = read_csv("Data/Europe_USA/model_output_preference_brain_it_europe_usa_qualitative.csv")

p1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


p3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA 4 levels")  + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))

p4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight / IT") +
ggtitle("USA 4 levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4"))


#Load land use filtered data and models
long_data <- read_csv("Data/Europe_USA/data_preference_residuals_europe_usa_subset_qualitative.csv")

model1 = read_csv("Data/Europe_USA/model_output_preference_residuals_europe_usa_subset_qualitative.csv")

model2 = read_csv("Data/Europe_USA/model_output_preference_brain_weight_europe_usa_subset_qualitative.csv")

model3 = read_csv("Data/Europe_USA/model_output_preference_it_europe_usa_subset_qualitative.csv")

model4 = read_csv("Data/Europe_USA/model_output_preference_brain_it_europe_usa_subset_qualitative.csv")

pp1 = ggplot(model1, aes(x = residuals, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = residuals, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Residuals") + 
ggtitle("USA levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp2 = ggplot(model2, aes(x = Brain.weight, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = Brain.weight, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight") +
ggtitle("USA levels") + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")


pp3 = ggplot(model3, aes(x = IT, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = IT, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Intertegular distance") +
ggtitle("USA levels")  + scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

pp4 = ggplot(model4, aes(x = brain_it, y = estimate__, color=Habitat)) +
geom_point(data =  long_data, aes(x = brain_it, y = (Preference)), shape=21) +
geom_line(aes(color=Habitat)) +
theme_bw() +
ylab("Habitat preference") +
xlab("Brain weight /` IT") +
ggtitle("USA levels") + 
scale_color_manual(values=c('Agricultural'='brown', 'Natural'='forestgreen', 'Urban'='purple4', "Seminatural"="cyan4")) +
theme(legend.position = "none")

library(patchwork)
p1 + pp1 + p2 + pp2 + p3 + pp3 + p4 + pp4 + plot_layout(ncol = 2) + plot_layout(guides = "collect")

```
